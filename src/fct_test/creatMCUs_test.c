#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include "../../include/creatMCUs.h"

int main() {
    // Définition des valeurs Y pour le test
    uint8_t Y_values[1][64] = {{
        0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00,
        0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00,
        0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,
        0xff, 0xff, 0x00, 0xff, 0xff, 0x00, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00,
        0x00, 0xff, 0x00, 0xff, 0xff, 0x00, 0xff, 0x00,
        0xff, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0xff
    },
    {
        0x00, 0x00, 0x00, 0xff, 0xff, 0x00, 0x00, 0x00,
        0x00, 0x00, 0xff, 0xff, 0xff, 0xff, 0x00, 0x00,
        0x00, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0x00,
        0xff, 0xff, 0x00, 0xff, 0xff, 0x00, 0xff, 0xff,
        0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff,
        0x00, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0x00,
        0x00, 0xff, 0x00, 0xff, 0xff, 0x00, 0xff, 0x00,
        0xff, 0x00, 0xff, 0x00, 0x00, 0xff, 0x00, 0xff
    }};

    // Définition des autres paramètres
    uint8_t numYbyMCU = 1;
    uint64_t number_of_mcu = 2;
    char PGM_PPM[] = "P5";

    // Appel de la fonction pour créer les MCUs
    MCU_type* MCUs = creatMCUs(PGM_PPM, Y_values, numYbyMCU, NULL, 0, NULL, 0, number_of_mcu);

    // Affichage des valeurs de l'MCU pour vérifier l'initialisation
    printf("MCU[0] Y values:\n");
    for (uint8_t i = 0; i < numYbyMCU; i++) {
        for (uint8_t j = 0; j < 64; j++) {
            printf("%02X ", MCUs[0].Y[i][j]);
            if ((j + 1) % 8 == 0) {
                printf("\n");
            }
        }
    }
    printf("MCU[1] Y values:\n");
    for (uint8_t i = 0; i < numYbyMCU; i++) {
        for (uint8_t j = 0; j < 64; j++) {
            printf("%02X ", MCUs[1].Y[i][j]);
            if ((j + 1) % 8 == 0) {
                printf("\n");
            }
        }
    }

    // Libération de la mémoire allouée pour les MCUs
    free_MCUs(MCUs, 1);

    return EXIT_SUCCESS;
}
